<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f14" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Aufgaben RA93">
  
  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./styles.css" />
  <link rel="icon" href="./icon-192.png">
  <link rel="apple-touch-icon" href="./icon-192.png">

  <title>Aufgabenliste ZDL RA 93</title>
</head>
<body>

  <header class="topbar">
    <div class="brand">Aufgaben RA 93</div>
    <div class="right">
      <span id="whoami" class="who">â€”</span>
      <button id="settingsBtn" class="btn ghost" style="padding:6px 10px; font-size:1.2rem">âš™ï¸</button>
      <button id="reloadBtn" class="btn ghost">â†»</button>
      <button id="logoutBtn" class="btn ghost">Logout</button>
    </div>
  </header>

  <main class="container">

    <section id="loginView" class="card">
      <h2>Anmeldung</h2>
      <div class="grid">
        <label>Mitarbeiter <select id="nameSel" class="select"></select></label>
        <label>Passwort <input id="passInp" type="password" class="input" placeholder="Passwort" /></label>
      </div>
      <div class="row"><button id="loginBtn" class="btn grow">Starten</button></div>
    </section>

    <section id="appView" class="hidden">

      <section id="settingsCard" class="card hidden" style="border:1px solid var(--accent); background:#0f1623; margin-bottom:20px;">
        <div class="row between">
          <h3>Einstellungen & Urlaub</h3>
          <button id="closeSettingsBtn" class="btn ghost">X</button>
        </div>
        <p class="muted small">Push-Zeiten: 09, 12, 14, 16, 18 Uhr</p>
        <div class="row"><button id="reqPermBtn" class="btn grow">ğŸ”” Benachrichtigungen aktivieren</button></div>
        <div id="permStatus" class="muted small">Status: PrÃ¼fe...</div>
        <div class="divider"></div>
        <h4>ğŸŒ´ Urlaubsmodus (Stumm)</h4>
        <div class="grid">
          <label>Stumm bis (Datum YYYYMMDD)<input id="muteUntilInp" class="input" type="number" placeholder="z.B. 20260228" /></label>
        </div>
        <div class="row">
          <button id="saveMuteBtn" class="btn ghost">Speichern</button>
          <button id="clearMuteBtn" class="btn danger">Urlaub beenden</button>
        </div>
        <div id="muteStatus" class="small" style="color:orange; margin-top:10px"></div>
      </section>

      <section class="card tabs">
        <button class="tabbtn active" data-tab="tasksTab">Aufgaben</button>
        <button class="tabbtn" data-tab="hygieneTab">Grunddesinfektion</button>
        <button class="tabbtn" data-tab="ridesTab">Fahrten</button>
        <button class="tabbtn" data-tab="adminTab" id="adminTabBtn">Admin</button>
      </section>

      <section id="tasksTab" class="tab card">
        <div class="row between"><h2>Tags</h2><input id="tagSearch" class="search" placeholder="Suche Tag..." /></div>
        <div id="tagList" class="list"></div>
        <div class="divider"></div>
        <h2 id="openTagTitle">Kein Tag geÃ¶ffnet</h2>
        <div class="row"><label class="grow">Erledigt von <select id="doneBySel" class="select" multiple size="4"></select></label></div>
        <div class="row"><button id="markSelectedDoneBtn" class="btn grow">âœ… Erledigen</button></div>
        <div class="muted small" id="taskHint" style="color:var(--accent)"></div>
        <div id="taskList" class="list"></div>
        <button id="newDailyTaskBtn" class="btn ghost hidden" style="margin-top:20px">+ Tagesaufgabe</button>
      </section>

      <section id="hygieneTab" class="tab card hidden">
        <div class="row between"><h2>Grunddesinfektion</h2><span class="pill">TÃ¤glich</span></div>
        <div id="hygieneUserList" class="list"></div>
      </section>

      <section id="ridesTab" class="tab card hidden">
        <h2>Fahrten (72h)</h2>
        <div class="grid2"><label>Fahrer <select id="rideNameSel" class="select"></select></label><label>Einsatz <input id="rideEinsatz" class="input" type="number" /></label></div>
        <div class="row"><button id="addRideBtn" class="btn grow">Speichern (+1 Pkt)</button></div>
        <div class="divider"></div>
        <div id="ridesList" class="list"></div>
      </section>

      <section id="adminTab" class="tab card hidden">
        <div class="row between"><h2>Admin</h2><span id="adminBadge" class="pill">ADMIN</span></div>
        <div id="adminArea">
          <section class="cardlite subtabs">
            <button class="subtabbtn active" data-subtab="toolsSub">Endkontrolle</button>
            <button class="subtabbtn" data-subtab="planSub">Wochenplan</button>
            <button class="subtabbtn" data-subtab="hygieneAdminSub">GD-Setup</button>
            <button class="subtabbtn" data-subtab="employeesSub">Mitarbeiter</button>
          </section>

          <section id="toolsSub" class="subtab">
            <h4 style="color:var(--accent)">ğŸ“‹ Aufgaben (Punkte)</h4>
            <div id="finalListTasks" class="list"></div>
            <div class="divider"></div>
            <h4 style="color:orange">ğŸ§¹ Grunddesinfektion (Keine Pkt)</h4>
            <div id="finalListHygiene" class="list"></div>
            <div class="divider"></div>
            <button id="regenTestBtn" class="btn" style="background:orange; color:black; width:100%">ğŸ› ï¸ TEST: Heute neu generieren</button>
          </section>

          <section id="planSub" class="subtab hidden">
            <div class="grid2">
              <label>Tag <select id="planWeekdaySel" class="select"><option value="all">-- ALLE --</option><option value="1">Mo</option><option value="2">Di</option><option value="3">Mi</option><option value="4">Do</option><option value="5">Fr</option><option value="6">Sa</option><option value="7">So</option></select></label>
              <label>Bereich <select id="planTagSel" class="select"></select></label>
            </div>
            <div class="row"><input id="planTaskInp" class="input" placeholder="Aufgabe..." /><button id="planAddBtn" class="btn ghost">+</button></div>
            <div id="planList" class="list"></div>
          </section>

          <section id="hygieneAdminSub" class="subtab hidden">
            <h3>Kategorien</h3>
            <div class="row"><input id="hygieneCatInp" class="input" /><button id="hygieneCatAddBtn" class="btn ghost">+</button></div>
            <div id="hygieneCatList" class="list"></div>
            <div class="divider"></div>
            <h3>Vorlagen</h3>
            <div class="grid2"><label>Kat <select id="hygieneItemCatSel" class="select"></select></label><input id="hygieneItemInp" class="input" /></div>
            <button id="hygieneItemAddBtn" class="btn ghost" style="margin-top:10px">Speichern</button>
            <div id="hygieneTemplateList" class="list"></div>
          </section>

          <section id="employeesSub" class="subtab hidden">
            <div class="row"><input id="empAdd" class="input" /><button id="empAddBtn" class="btn ghost">Add</button></div>
            <div id="empList" class="list"></div>
            <div class="divider"></div>
            <div class="row"><input id="adminUidAdd" class="input" placeholder="Admin Name" /><button id="adminUidAddBtn" class="btn ghost">+</button></div>
          </section>

        </div>
      </section>
    </section>
  </main>

  <script type="module" src="./app.js"></script>
  <script>
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('./sw.js'); }
  </script>
</body>
</html>
