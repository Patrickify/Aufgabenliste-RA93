<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f14" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="stylesheet" href="./styles.css" />
  <title>RA 93 Pro - Vollversion</title>
</head>
<body>

  <header class="topbar">
    <div class="top-left">
      <button id="menuToggle" class="btn ghost">â˜°</button>
      <div class="brand">RA 93 Pro</div>
    </div>
    <div class="top-right">
      <span id="whoami" class="who">â€”</span>
      <button id="settingsBtn" class="btn ghost">âš™ï¸</button>
      <button id="reloadBtn" class="btn ghost">â†»</button>
      <button id="logoutBtn" class="btn ghost">Logout</button>
    </div>
  </header>

  <section id="settingsCard" class="modal hidden">
    <div class="modal-content card">
      <div class="row between"><h3>Einstellungen</h3><button id="closeSettingsBtn" class="btn ghost">X</button></div>
      <div class="divider"></div>
      <h4>ğŸ”” Benachrichtigungen</h4>
      <p class="small muted">Damit Ticket-Updates & Erinnerungen ankommen.</p>
      <button id="reqPushBtn" class="btn ghost" style="width:100%; margin-bottom: 20px;">Push aktivieren</button>
      <h4>ğŸŒ´ Urlaubsmodus</h4>
      <input id="muteUntilInp" class="input" type="number" placeholder="Datum z.B. 20260520" />
      <div class="row">
        <button id="saveMuteBtn" class="btn grow">Speichern</button>
        <button id="clearMuteBtn" class="btn danger">Beenden</button>
      </div>
    </div>
  </section>

  <section id="loginView" class="container">
    <div class="card login-card">
      <h2>Anmeldung</h2>
      <p class="muted">Bitte gib deinen Namen und dein Passwort ein.</p>
      <div class="grid" style="margin-top: 20px;">
        <label>Name <input id="nameInp" type="text" class="input" placeholder="Vorname Nachname..." /></label>
        <label>Passwort <input id="passInp" type="password" class="input" placeholder="Passwort eingeben..." /></label>
      </div>
      <button id="loginBtn" class="btn grow" style="margin-top:20px">Starten</button>
    </div>
  </section>

  <div id="appView" class="main-layout hidden">
    <nav id="sidebar" class="sidebar">
      <div class="sidebar-header">HauptmenÃ¼</div>
      <button class="tabbtn active" data-tab="tasksTab">ğŸ“‹ Aufgaben</button>
      <button class="tabbtn" data-tab="hygieneTab">ğŸ§¹ Grunddesinfektion</button>
      <button class="tabbtn" data-tab="ridesTab">ğŸš— Fahrtenbuch</button>
      <div class="divider"></div>
      <button class="tabbtn hidden" data-tab="ticketTab" id="ticketTabBtn">ğŸ« Dashboard & Tickets</button>
      <button class="tabbtn hidden" data-tab="adminTab" id="adminTabBtn">âš™ï¸ Admin Bereich</button>
    </nav>

    <main class="container">
      
      <section id="tasksTab" class="tab">
        <div class="card">
          <h3>Bereiche</h3>
          <input id="tagSearch" class="search" placeholder="Bereich suchen..." />
          <div id="tagList" class="list"></div>
        </div>
        <div class="divider"></div>
        <div class="card">
          <h2 id="openTagTitle">Bereich wÃ¤hlen</h2>
          <div class="cardlite">
            <p class="small muted">Mitarbeiter fÃ¼r diese Aufgabe auswÃ¤hlen:</p>
            <div id="doneByCheckBoxes" class="checkbox-list"></div>
          </div>
          <p id="taskHint" class="task-selection-hint"></p>
          <button id="markSelectedDoneBtn" class="btn grow">âœ… Erledigt markieren</button>
          <div id="taskList" class="list" style="margin-top: 15px;"></div>
        </div>
      </section>

      <section id="hygieneTab" class="tab hidden">
        <div class="card"><h2>Grunddesinfektion</h2><div id="hygieneUserList" class="list"></div></div>
      </section>

      <section id="ridesTab" class="tab hidden">
        <div class="card">
          <h2>Fahrten eintragen</h2>
          <div class="grid2">
            <label>Fahrer <select id="rideNameSel" class="select"></select></label>
            <label>Einsatznr <input id="rideEinsatz" class="input" type="number" /></label>
          </div>
          <button id="saveRideBtn" class="btn grow">Fahrt zur Abnahme senden</button>
          <div id="ridesList" class="list" style="margin-top:20px"></div>
        </div>
      </section>

      <section id="ticketTab" class="tab hidden">
        <div class="card admin-nav">
          <button class="subtabbtn active" data-subtab="dashSub">Dashboard</button>
          <button class="subtabbtn" data-subtab="myTicketsSub">Tickets verwalten</button>
          <button class="subtabbtn hidden" data-subtab="ticketSetupSub" id="ticketSetupBtn">Ticket Setup (DL)</button>
        </div>

        <section id="dashSub" class="subtab">
          <div class="card">
            <div class="row between"><h3>Wichtige Infos</h3></div>
            <div id="infoBoardList" class="list"></div>
            <div class="divider"></div>
            <input id="infoBoardInp" class="input" placeholder="Neue Info posten..." />
            <button id="infoBoardAddBtn" class="btn ghost">Info pinnen</button>
          </div>
          <div class="card">
            <h3>Ã–ffentliche Ticket-Ãœbersicht</h3>
            <p class="small muted">Tickets, die fÃ¼r das gesamte FÃ¼hrungsteam sichtbar geschaltet wurden.</p>
            <div id="publicTicketsList" class="list"></div>
          </div>
        </section>

        <section id="myTicketsSub" class="subtab hidden">
          <div class="card">
            <h3>Neues Ticket erstellen</h3>
            <div class="grid">
              <input id="ticketTitleInp" class="input" placeholder="Kurzer Titel (z.B. Defekt Trage)" />
              <textarea id="ticketDescInp" class="input" placeholder="Genaue Beschreibung..."></textarea>
              <select id="ticketCatSel" class="select"><option value="">ZustÃ¤ndigkeitsbereich wÃ¤hlen...</option></select>
            </div>
            <button id="createTicketBtn" class="btn grow" style="margin-top:10px;">Ticket absenden</button>
          </div>
          <div class="card">
            <h3>Meine Tickets (Erstellt & Zugewiesen)</h3>
            <div id="myTicketsList" class="list"></div>
          </div>
        </section>

        <section id="ticketSetupSub" class="subtab hidden">
          <div class="card">
            <h3>Aufgabengebiete & ZustÃ¤ndigkeiten</h3>
            <p class="small muted">Erstelle Kategorien und weise eine Person zu.</p>
            <div class="grid">
              <input id="ticketCatNameInp" class="input" placeholder="Kategorie (z.B. Fuhrpark)" />
              <select id="ticketCatAssigneeSel" class="select"></select>
            </div>
            <button id="addTicketCatBtn" class="btn ghost" style="margin-top:10px;">Bereich erstellen</button>
            <div id="ticketCatList" class="list" style="margin-top:15px;"></div>
          </div>
        </section>
      </section>

      <section id="adminTab" class="tab hidden">
        <div class="card admin-nav">
          <button class="subtabbtn active" data-subtab="toolsSub">Abnahmen</button>
          <button class="subtabbtn" data-subtab="planSub">Wochenplan</button>
          <button class="subtabbtn" data-subtab="statsSub">Ranking</button>
          <button class="subtabbtn" data-subtab="setupSub">System</button>
        </div>

        <section id="toolsSub" class="subtab">
          <div class="card">
            <h4>â• Zusatztagesaufgabe (Nur fÃ¼r heute)</h4>
            <div class="grid2"><select id="extraTaskTagSel" class="select"></select><input id="extraTaskInp" class="input" placeholder="Was ist heute zu tun?" /></div>
            <button id="addExtraTaskBtn" class="btn grow">Heute hinzufÃ¼gen</button>
          </div>
          <div class="card">
            <h4>ğŸš— Offene Abnahmen (Fahrten)</h4><div id="finalListRides" class="list"></div><div class="divider"></div>
            <h4>ğŸ“‹ Offene Abnahmen (Aufgaben)</h4><div id="finalListTasks" class="list"></div><div class="divider"></div>
            <h4>ğŸ§¹ Offene Abnahmen (GD)</h4><div id="finalListHygiene" class="list"></div>
            <button id="regenTestBtn" class="btn danger" style="width:100%; margin-top:30px">ğŸ› ï¸ Tag Reset (Daten neu laden)</button>
          </div>
        </section>

        <section id="planSub" class="subtab hidden">
          <div class="card">
            <h4>Wochenplan Filter</h4>
            <div class="grid2">
              <select id="planDaySel" class="select"><option value="1">Mo</option><option value="2">Di</option><option value="3">Mi</option><option value="4">Do</option><option value="5">Fr</option><option value="6">Sa</option><option value="7">So</option></select>
              <select id="planTagSel" class="select"></select>
            </div>
            <div id="planList" class="list" style="margin-top:15px"></div>
            <div class="divider"></div>
            <input id="planTextInp" class="input" placeholder="Aufgabentext..." /><button id="planAddBtn" class="btn grow">Speichern</button>
          </div>
        </section>

        <section id="statsSub" class="subtab hidden">
          <div class="card">
            <div class="row between"><h3>Punkte-Ranking</h3><button id="exportCsvBtn" class="btn ghost">ğŸ“Š CSV Export</button></div>
            <table style="width:100%; text-align:left; margin-top: 15px;">
              <thead><tr><th>Name</th><th>Aufg.</th><th>Fahrten</th><th>Gesamt</th></tr></thead>
              <tbody id="pointsTableBody"></tbody>
            </table>
          </div>
        </section>

        <section id="setupSub" class="subtab hidden">
          <div class="card">
            <h4>1. Globale PunkteÃ¤nderung (Reset)</h4>
            <div class="grid2"><label>Aufgaben (Pkte) <input id="editTasksInp" type="number" class="input" value="0" /></label><label>Fahrten (Pkte) <input id="editRidesInp" type="number" class="input" value="0" /></label></div>
            <button id="savePointsBtn" class="btn danger">Punkte fÃ¼r ALLE Ã¼berschreiben</button>
          </div>
          <div class="card">
            <h4>2. Bereiche (Tags)</h4>
            <div class="row"><input id="tagAddInp" class="input" placeholder="z.B. RTW 1"/><button id="tagAddBtn" class="btn ghost">+</button></div>
            <div id="adminTagList" class="list"></div>
          </div>
          <div class="card">
            <h4>3. Mitarbeiter Liste</h4>
            <div class="row"><input id="empAdd" class="input" placeholder="Neuer Name"/><button id="empAddBtn" class="btn ghost">+</button></div>
            <div id="empList" class="list"></div>
          </div>
          <div class="card">
            <h4>4. Rollen / Rechte vergeben</h4>
            <div class="row"><input id="dlUidAdd" class="input" placeholder="Dienststellenleitung..."/><button id="dlUidAddBtn" class="btn ghost">Leitung +</button></div>
            <div class="row"><input id="adminUidAdd" class="input" placeholder="Admin..."/><button id="adminUidAddBtn" class="btn ghost">Admin +</button></div>
            <div class="row"><input id="superUidAdd" class="input" placeholder="Superadmin..."/><button id="superUidAddBtn" class="btn ghost">Super +</button></div>
            <div class="divider"></div>
            <p class="small muted">Normale User-Zuweisungen:</p>
            <div class="row"><input id="eaUidAdd" class="input" placeholder="Ehrenamtlich..."/><button id="eaUidAddBtn" class="btn ghost">EA +</button></div>
            <div class="row"><input id="ziviUidAdd" class="input" placeholder="Zivildiener..."/><button id="ziviUidAddBtn" class="btn ghost">Zivi +</button></div>
          </div>
          <div class="card">
            <h4>5. Hygiene Vorlagen</h4>
            <div class="row"><input id="hygieneCatInp" class="input" placeholder="Neue Kategorie..."/><button id="hygieneCatAddBtn" class="btn ghost">+</button></div>
            <div id="hygieneCatList" class="list"></div>
            <div class="divider"></div>
            <select id="hygieneItemCatSel" class="select"></select>
            <input id="hygieneItemInp" class="input" placeholder="Name (z.B. RTW desinfizieren)"/>
            <textarea id="hygieneSubtasksInp" class="input" placeholder="Checkliste: Pro Zeile ein Punkt" style="height: 100px;"></textarea>
            <button id="hygieneItemAddBtn" class="btn grow">Vorlage speichern</button>
          </div>
          <div class="card">
            <h4>6. Punkte-System konfigurieren</h4>
            <div class="grid2"><label>Punkte pro Aufgabe <input id="configTaskPoints" type="number" class="input" value="1" /></label><label>Punkte pro Fahrt <input id="configRidePoints" type="number" class="input" value="1" /></label></div>
            <button id="saveConfigPointsBtn" class="btn grow">Werte speichern</button>
          </div>
        </section>
      </section>
    </main>
  </div>

  <div id="checkModal" class="modal hidden">
    <div class="modal-content card">
      <h3 id="modalTitle">Checkliste</h3>
      <div id="modalSubtasks" class="list"></div>
      <div class="row"><button id="closeModalBtn" class="btn ghost">Abbruch</button><button id="saveCheckBtn" class="btn grow">AbschlieÃŸen</button></div>
    </div>
  </div>

  <div id="ticketModal" class="modal hidden">
    <div class="modal-content card">
      <div class="row between"><h3 id="tModTitle">Ticket</h3><button id="tModCloseBtn" class="btn ghost">X</button></div>
      <p id="tModDesc" class="muted small"></p>
      <div id="tModHistory" class="ticket-history"></div>
      
      <div class="divider"></div>
      <textarea id="tModCommentInp" class="input" placeholder="Neues Kommentar..."></textarea>
      <button id="tModSendCommentBtn" class="btn ghost" style="width:100%; margin-bottom:10px;">ğŸ’¬ Kommentar senden</button>
      
      <div id="tModAssigneeArea" class="hidden cardlite">
        <h4>Aktionen (FÃ¼r ZustÃ¤ndige)</h4>
        <div class="row between">
          <label style="display:flex; align-items:center; gap:5px;"><input type="checkbox" id="tModPublicCheck" style="width:20px;height:20px;"> <span>Im Dashboard sichtbar</span></label>
        </div>
        <div class="divider"></div>
        <textarea id="tModCloseInp" class="input" placeholder="Was wurde gemacht, um das Ticket zu schlieÃŸen?"></textarea>
        <button id="tModCloseTicketBtn" class="btn danger" style="width:100%;">ğŸ”’ Ticket abschlieÃŸen & archivieren</button>
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
